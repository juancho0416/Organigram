@page
@model IndexModel
@{
    ViewData["Title"] = "Organigrama";
    Layout = "_Layout";
}

@section Styles {
    <link rel="stylesheet" href="~/css/site.css">
}

<div class="app-container">
    <header class="app-header">
        <div class="brand">
            <div class="logo-dot"></div>
            Organigrama TI
        </div>
        <div class="header-actions">
            <button id="toggleViewBtn" class="btn btn-secondary" onclick="window.toggleView()">
                Ver Diagrama &nbsp;
            </button>
            <input type="search" id="buscador" placeholder="Buscar personal..." class="search-input"
                aria-label="Búsqueda de personal">
            <button class="btn btn-secondary" onclick="window.toggleFilterPanel()" id="filterBtn">
                Filtros de Área &nbsp;
            </button>
        </div>
    </header>

    <main class="main-content">
        <nav class="breadcrumb-nav" aria-label="Ruta de navegación">
            <ul id="breadcrumb" class="breadcrumb-list">
            </ul>
        </nav>

        <div id="org-view" class="org-view view-active">
            <div id="current-chief-module" class="chief-module-container"></div>
            <div id="subordinate-list" class="subordinate-list">
            </div>
        </div>

        <div id="area-results-view" class="area-results-view" style="display:none;">
        </div>

        <div id="org-chart-tree-container" class="org-chart-tree-container" style="display:none;">
            <div id="treeControls" class="tree-controls">
                <button id="centerViewBtn" class="btn btn-secondary" onclick="window.centerView()">
                    Centrar Vista
                </button>
            </div>

            <div id="org-chart-tree" class="org-chart-tree org-view">
            </div>
        </div>
    </main>

    <dialog id="detalleModal" class="modal">
        <div id="modalCard" class="modal-card">
            <header class="modal-header">
                <div class="badge">
                    <span id="modalBadgeDot" class="badge-dot"></span>
                    <h2 id="modalNombre"></h2>
                </div>
                <button class="btn-cerrar" value="close" onclick="cerrarModal()" aria-label="Cerrar modal">✕</button>
            </header>
            <div class="modal-content">
                <div class="modal-avatar">
                    <div id="modalAvatar" class="avatar" role="img"></div>
                </div>
                <div class="modal-info">
                    <div class="detail-group">
                        <div class="label">Puesto:</div>
                        <div id="modalPuesto" class="value"></div>
                    </div>
                    <div class="detail-group">
                        <div class="label">Área:</div>
                        <div id="modalArea" class="value"></div>
                    </div>
                    <div class="detail-group">
                        <div class="label">Email:</div>
                        <div id="modalEmail" class="value"></div>
                    </div>
                    <hr />
                    <p class="notes">Perfil completo y responsabilidades del puesto.</p>
                </div>
            </div>
            <footer class="modal-footer">
                <button class="btn btn-accent">Ver Perfil Completo</button>
                <button class="btn btn-cerrar" onclick="cerrarModal()">Cerrar</button>
            </footer>
        </div>
    </dialog>
</div>

<div id="quickTooltip" class="quick-tooltip" style="display: none;"></div>

<div id="filterPanel" class="filter-panel" aria-hidden="true">
    <div class="filter-header">
        <h3>Filtro por Áreas </h3>
        <button class="btn-cerrar" onclick="window.toggleFilterPanel()" aria-label="Cerrar Panel">✕</button>
    </div>
    <div id="filterOptionsContainer" class="filter-options-container">
    </div>
    <div class="filter-actions">
        <button class="btn btn-accent" onclick="window.applyFilters()">Aplicar Filtros</button>
        <button class="btn btn-secondary" onclick="window.clearFilters()">Limpiar Filtros</button>
    </div>
</div>

<div id="filterOverlay" class="filter-overlay" onclick="window.toggleFilterPanel()"></div>


@section Scripts {
    <script src="~/js/nodos.js"></script>
    <script src="~/js/site.js"></script>
}